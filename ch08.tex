除了普通的节点和边属性数据，Cytoscape~还支持导入基因表达数据。基因表达数据的格式跟一般的属性文件的格式不一样，但是对于Cytoscape来说，最终对这些属性的处理方法却没有区别。基因表达数据（跟属性数据一样）在任何时候都可以导入，但（通常）都是在网络加载后导入一次。 

 \subsubsection{数据文件格式}
一个或多个实验所得到的基因表达比例（gene expression ratio）或称基因表达值（value）都是用文本文件存储的。比例结果来自于两个基因表达测试（实验组和对照组）的比较。在某些基因表达平台上，例如Affymetrix，可以直接测出基因表达值，而无需比较。文件包括一个头部，以及若干用空格或制表符分割的域，每一行都是一个基因，大概的格式如下：
\begin{verbatim}
Identifier [CommonName] value1 value2 ... valueN [pval1 pval2 ... pvalN]
\end{verbatim}
方括号\[ \]表示该域是可选的。

第一个域用于识别该基因对应Cytoscape中的哪个节点。在最简单的情况下，这就是基因的名称，跟其在Cytoscape中的网络中的名称完全一致（大小写敏感）。此外，也可以是能识别节点的某些属性，例如商业微阵列的探针标识。

接下来的一个域是常见名称，可选的。这对于Cytoscape并没有什么用，只是用户的习惯而已。有了这个CommonName域，该输入文件的格式就跟其它的常见的基因表达数据分析包一致了，例如SAM（\url{http://www-stat.stanford.edu/~tibs/SAM/}）。 

接下来的就是各个实验所测得的基因表达值。这些值可以使绝对的基因表达值，也可以fold change的比例。可以根据第一行中的实验名称来区分各个实验。

还有一个可选的值表示显著程度的P值。很多阵列数据分析包都能计算出这个值，表示基因表达或fold change较随机情况的显著程度。显著度会列在基因表达数据后面。显著度的名称应该跟基因表达数据的实验名称完全一致。

看一个例子，下面是Cytoscape的sampleData目录中galExpData.pvals文件的节选：
\begin{verbatim}
GENE COMMON gal1RG gal4RG gal80R gal1RG gal4RG gal80R
YHR051W COX6 -0.034 0.111 -0.304 3.75720e-01 1.56240e-02 7.91340e-06
YHR124W NDT80 -0.090 0.007 -0.348 2.71460e-01 9.64330e-01 3.44760e-01
YKL181W PRS1 -0.167 -0.233 0.112 6.27120e-03 7.89400e-04 1.44060e-01
YGR072W UPF3 0.245 -0.471 0.787 4.10450e-04 7.51780e-04 1.37130e-05
\end{verbatim}
在这个数据中有三个实验：gal1RG，gal4RG和gal80R。这三个名称在表头中出现了两次，首先是基因表达值，然后是显著度。例如，从第二行数据可知，在gal1RG试验中，YHR051W的基因表达值是-0.034，显著度是3.75720e-01。

在基本格式上还能有一些变动，详见下面的文件格式说明。基因表达数据文件通常的后缀是``.mrna''或``.pvals''，这些文件都能被Cytoscape识别。
\subsubsection{基本过程}
用File $\rightarrow$ Import $\rightarrow$ Attribute/Expression Matrix...加载基因表达矩阵数据，会弹出导入窗口；还可以用命令行选项-m指定基因表达数据文件。如果用命令行加载基因表达数据，则基因表达数据必须按照节点ID输入。如果用对话框，可以根据节点的ID加载基因表达数据（缺省），也可以根据其他的节点属性加载基因表达数据。如果使用某个节点属性，该属性必须满足（1）该属性已经加载了；（2）该属性必须跟基因表达举证文件第一行相匹配。
 
\subsubsection{实例}
下面针对sampleData/galFiltered.sif网络演示一下如何导入基因表达数据： 
\begin{enumerate}
\renewcommand{\labelenumi}{\textbf{Option \Alph{enumi}.}}
\item 点击File $rightarrow$ Import $rightarrow$ Attribute/Expression Matrix\ldots 。在结果窗口中，有一个名为``Please select an attribute or expression matrix file\ldots''，用Select按钮输入sampleData/galExpData.pvals。这个文件中的标识符和sampleData/galFiltered.sif网络数据中的标识符是一致的，所以不需要使用``Assign values to nodes using...''。下面是这个文件中的几行内容：
\begin{verbatim}
GENE COMMON gal1RG gal4RG gal80R gal1RG gal4RG gal80R
YHR051W COX6 -0.034 0.111 -0.304 3.75720e-01 1.56240e-02 7.91340e-06
YHR124W NDT80 -0.090 0.007 -0.348 2.71460e-01 9.64330e-01 3.44760e-01
YKL181W PRS1 -0.167 -0.233 0.112 6.27120e-03 7.89400e-04 1.44060e-01
\end{verbatim}
\item 第1步：在加载网络后，再用File$\rightarrow$Import$\rightarrow$Node attributes\ldots加载sampleData/gal.probeset.na中的节点属性。下面是这个文件的部分内容：
\begin{verbatim}
Probeset
YHR051W = probeset2
YHR124W = probeset3
YKL181W = probeset4
\end{verbatim}
第2步：在加载了节点属性文件后，选择基因表达数据文件sampleData.galExpPvals.probeset.pvals，下面是该文件的部分内容： 
 \begin{verbatim}
GENE COMMON gal1RG gal4RG gal80R gal1RG gal4RG gal80R
probeset2 COX6 -0.034 0.111 -0.304 3.75720e-01 1.56240e-02 7.91340e-06
probeset3 NDT80 -0.090 0.007 -0.348 2.71460e-01 9.64330e-01 3.44760e-01
probeset4 PRS1 -0.167 -0.233 0.112 6.27120e-03 7.89400e-04 1.44060e-01
\end{verbatim}
在选择了文件后，在``Assign values to nodes using...''中选择~Probeset。这会导入跟前一个例子中完全一样的基因表达数据，但在节点名称不能用作标识符的情况下，这会更加灵活。
\end{enumerate}
\subsubsection{文件格式的详细说明（高级用户）}
在基因表达数据文件中，任何空白（空格或制表符）都被视为相邻域的分隔符。数据中的各行只有可能是表头或是某个基因的各个测量值。名称转换不适用于基因表达数据文件。

基因表达数据中第一列给出的名称必须跟其它地方所使用的基因名称完全一致（例如SIF或GML文件）。

第一行是表头行，格式有以下三种：
\begin{verbatim}
<text> <text> cond1 cond2 ... cond1 cond2 ... [NumSigConds]
<text> <text> cond1 cond2 ...
<tab><tab>RATIOS<tab><tab>...LAMBDAS
\end{verbatim}
第一种格式中既有基因表达比例，也有显著度。前两个尖括号中的是基因的名称，例如正式名称和常见名称。
The first format specifies that both expression ratios and significance values are included in the file. The first two text tokens (in angled brackets) contain names for each gene, such as the formal and common gene names. The condX token set specifies the names of the experimental conditions; these columns will contain ratio values. This list of condition names must then be duplicated exactly, each spelled the same way and in the same order. Optionally, a final column with the title NumSigConds may be present. If present, this column will contain integer values indicating the number of conditions in which each gene had a statistically significant change according to some threshold. 

The second format is similar to the first except that the duplicate column names are omitted, and there is no NumSigConds field. This format specifies data with ratios but no significance values. 

The third format specifies an MTX header, which is a commonly used format. Two tab characters precede the RATIOS token. This token is followed by a number of tabs equal to the number of conditions, followed by the LAMBDAS token. This format specifies both ratios and significance values. 

Each line after the first is a data line with the following format: 
\begin{verbatim}
FormalGeneName CommonGeneName ratio1 ratio2 ... [lambda1 lambda2 ...] [numSigConds]
\end{verbatim}
The first two tokens are gene names. The names in the first column are the keys used for node name lookup; these names should be the same as the names used elsewhere in Cytoscape (i.e. in the SIF, GML, or XGMML files). Traditionally in the gene expression microarray community, who defined these file formats, the first token is expected to be the formal name of the gene (in systems where there is a formal naming scheme for genes), while the second is expected to be a synonym for the gene commonly used by biologists, although Cytoscape does not make use of the common name column. The next columns contain floating point values for the ratios, followed by columns with the significance values if specified by the header line. The final column, if specified by the header line, should contain an integer giving the number of significant conditions for that gene. Missing values are not allowed and will confuse the parser. For example, using two consecutive tabs to indicate a missing value will not work; the parser will regard both tabs as a single delimiter and be unable to parse the line correctly. 

Optionally, the last line of the file may be a special footer line with the following format: 
 \begin{verbatim}
NumSigGenes int1 int2 ...
\end{verbatim}
This line specified the number of genes that were significantly differentially expressed in each condition. The first text token must be spelled exactly as shown; the rest of the line should contain one integer value for each experimental condition. 
